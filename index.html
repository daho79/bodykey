<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BodyKey - Weight Management</title>
    <meta name="description" content="BodyKey - Your comprehensive weight management companion. Track progress, set goals, and stay motivated.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéØ</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-size: 28px;
            font-weight: bold;
            color: #667eea;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        nav {
            margin-top: 20px;
        }

        nav button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 0 5px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        nav button:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        nav button.active {
            background: #764ba2;
        }

        .content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .welcome-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .welcome-section h1 {
            font-size: 3em;
            color: #667eea;
            margin-bottom: 20px;
        }

        .welcome-section p {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 30px;
        }

        .cta-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .cta-button:hover {
            transform: scale(1.05);
        }

        .dashboard {
            display: none;
        }

        .dashboard.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .stat-card p {
            opacity: 0.9;
        }

        .tracking-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #667eea;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s ease;
        }

        .btn:hover {
            background: #5a6fd8;
        }

        .progress-chart {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .chart-placeholder {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            margin-top: 20px;
        }

        .goals-section, .motivation-section, .profile-section {
            display: none;
        }

        .goals-section.active, .motivation-section.active, .profile-section.active {
            display: block;
        }

        .goal-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .motivation-section {
            text-align: center;
        }

        .quote-card {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .quote-card h3 {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #d4691a;
        }

        .tips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .tip-card {
            background: linear-gradient(135deg, #e0c3fc 0%, #9bb5ff 100%);
            padding: 20px;
            border-radius: 15px;
        }

        .profile-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
        }

        .profile-avatar {
            text-align: center;
        }

        .avatar-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: white;
        }

        .github-info {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .github-info h3 {
            margin-bottom: 10px;
        }

        .github-link {
            color: white;
            text-decoration: none;
            font-weight: bold;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            display: inline-block;
            margin-top: 10px;
            transition: background 0.3s ease;
        }

        .github-link:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 768px) {
            .tracking-section {
                grid-template-columns: 1fr;
            }
            
            .profile-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            nav button {
                display: block;
                width: 100%;
                margin: 5px 0;
            }

            .welcome-section h1 {
                font-size: 2em;
            }
        }

        .status-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            font-weight: 600;
        }
        
        .recent-logs {
            margin-top: 30px;
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
        }
        
        .logs-container {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .log-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 60px;
            gap: 15px;
            align-items: center;
        }
        
        .log-item .log-date {
            font-weight: 600;
            color: #667eea;
        }
        
        .log-item .log-weight {
            font-size: 1.1em;
            font-weight: bold;
        }
        
        .log-item .log-details {
            font-size: 0.9em;
            color: #666;
        }
        
        .delete-log {
            background: #ff4757;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .data-management {
            margin-top: 30px;
            background: #fff3e0;
            border-radius: 15px;
            padding: 20px;
        }
        
        .management-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .btn-danger {
            background: #ff4757 !important;
        }
        
        .btn-danger:hover {
            background: #ff3742 !important;
        }
        
        .data-stats {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
        }
        
        .saved-goals {
            margin-top: 20px;
            background: #f0f8ff;
            border-radius: 15px;
            padding: 20px;
        }
        
        .goals-list {
            margin-top: 15px;
        }
        
        .goal-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .goal-text {
            flex: 1;
            font-weight: 500;
        }
        
        .goal-category {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin: 0 10px;
        }
        
        .goal-date {
            font-size: 0.9em;
            color: #666;
            margin: 0 10px;
        }
        
        .goal-actions {
            display: flex;
            gap: 5px;
        }
        
        .goal-complete {
            background: #2ed573;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .goal-delete {
            background: #ff4757;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
        }
        
        .goal-category-select,
        .goal-date {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            margin-top: 8px;
        }
        
        .import-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .import-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
        }
        
        .import-textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: monospace;
            resize: vertical;
        }
        
        .goal-item.completed {
            opacity: 0.7;
            background: #f0f8f0;
        }
        
        .save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2ed573;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .save-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .auto-save {
            font-size: 0.9em;
            color: #2ed573;
            margin-left: 10px;
        }
        
        .data-sync-status {
            background: #e8f5e8;
            color: #2d5016;
            padding: 10px 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .unsaved-changes {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Save Indicator -->
    <div id="save-indicator" class="save-indicator">
        <span id="save-text">üíæ Data Saved!</span>
    </div>
    
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">BK</div>
                BodyKey Weight Management
            </div>
            <nav>
                <button class="nav-btn active" data-section="home">üè† Home</button>
                <button class="nav-btn" data-section="dashboard">üìä Dashboard</button>
                <button class="nav-btn" data-section="goals">üéØ Goals</button>
                <button class="nav-btn" data-section="motivation">üí™ Motivation</button>
                <button class="nav-btn" data-section="profile">üë§ Profile</button>
            </nav>
        </header>

        <div class="content">
            <!-- Home Section -->
            <div id="home" class="section active">
                <div class="github-info">
                    <h3>üöÄ Now Hosted on GitHub Pages!</h3>
                    <p>Your BodyKey website is successfully deployed and accessible worldwide</p>
                    <a href="https://github.com" class="github-link" target="_blank">View on GitHub</a>
                </div>
                
                <div class="welcome-section">
                    <h1>üéØ Welcome to BodyKey</h1>
                    <p>Your comprehensive weight management companion. Track your progress, set goals, and stay motivated on your health journey.</p>
                    <button class="cta-button" onclick="showSection('dashboard')">Start Tracking Today</button>
                </div>
                
                <div class="status-message">
                    ‚úÖ Website is fully functional and hosted on GitHub Pages!
                </div>
            </div>

            <!-- Dashboard Section -->
            <div id="dashboard" class="section dashboard">
                <h2>üìä Your Dashboard</h2>
                
                <!-- Data Sync Status -->
                <div id="sync-status" class="data-sync-status">
                    <span>üíæ</span>
                    <span id="sync-message">All data saved automatically</span>
                    <span id="last-save" class="auto-save"></span>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="current-weight">75.0</h3>
                        <p>Current Weight (kg)</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="goal-weight">68.0</h3>
                        <p>Goal Weight (kg)</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="progress">-2.4</h3>
                        <p>Progress (kg)</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="bmi">24.8</h3>
                        <p>BMI</p>
                    </div>
                </div>

                <div class="tracking-section">
                    <div>
                        <h3>üìù Log Today's Data</h3>
                        <div class="input-group">
                            <label for="weight-input">Weight (kg)</label>
                            <input type="number" id="weight-input" placeholder="Enter your weight in kg" step="0.1">
                        </div>
                        <div class="input-group">
                            <label for="calories-input">Calories</label>
                            <input type="number" id="calories-input" placeholder="Daily calories">
                        </div>
                        <div class="input-group">
                            <label for="exercise-input">Exercise (minutes)</label>
                            <input type="number" id="exercise-input" placeholder="Exercise duration">
                        </div>
                        <button class="btn" onclick="logData()">Log Data</button>
                        <div id="log-message"></div>
                    </div>

                    <div class="progress-chart">
                        <h3>üìà Progress Chart</h3>
                        <div class="chart-placeholder">
                            <div>üìä Interactive Chart</div>
                            <small>(Chart.js integration ready)</small>
                        </div>
                    </div>
                </div>
                
                <!-- Recent Logs Section -->
                <div class="recent-logs">
                    <h3>üìã Recent Weight Logs</h3>
                    <div id="logs-display" class="logs-container">
                        <!-- Dynamic content will be loaded here -->
                    </div>
                </div>
                
                <!-- Data Management Section -->
                <div class="data-management">
                    <h3>üíæ Data Management</h3>
                    <div class="management-buttons">
                        <button class="btn" onclick="exportData()">üì§ Export Data</button>
                        <button class="btn" onclick="showImportDialog()">üì• Import Data</button>
                        <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è Clear All Data</button>
                    </div>
                    <div id="data-stats" class="data-stats">
                        <!-- Database statistics will be shown here -->
                    </div>
                </div>
            </div>

            <!-- Goals Section -->
            <div id="goals" class="section goals-section">
                <h2>üéØ Your Goals</h2>
                
                <div class="goal-card">
                    <h3>Primary Weight Goal</h3>
                    <p><strong>Target:</strong> Lose 7.0 kg</p>
                    <p><strong>Timeline:</strong> 3 months</p>
                    <p><strong>Progress:</strong> 34% complete</p>
                </div>

                <div class="goal-card">
                    <h3>Fitness Goals</h3>
                    <p><strong>Exercise:</strong> 30 minutes daily</p>
                    <p><strong>Steps:</strong> 10,000 steps per day</p>
                    <p><strong>Water:</strong> 8 glasses daily</p>
                </div>
                
                <!-- Saved Goals Display -->
                <div id="saved-goals" class="saved-goals">
                    <h3>üìã Your Saved Goals</h3>
                    <div id="goals-list" class="goals-list">
                        <!-- Dynamic goals will be loaded here -->
                    </div>
                </div>

                <div class="input-group">
                    <label for="new-goal">Set New Goal</label>
                    <input type="text" id="new-goal" placeholder="Enter your new goal">
                    <select id="goal-category" class="goal-category">
                        <option value="weight">Weight Loss</option>
                        <option value="fitness">Fitness</option>
                        <option value="nutrition">Nutrition</option>
                        <option value="general">General Health</option>
                    </select>
                    <input type="date" id="goal-date" class="goal-date">
                    <button class="btn" onclick="addGoal()">Add Goal</button>
                </div>
            </div>

            <!-- Motivation Section -->
            <div id="motivation" class="section motivation-section">
                <h2>üí™ Daily Motivation</h2>
                
                <div class="quote-card">
                    <h3>"Success is the sum of small efforts repeated day in and day out."</h3>
                    <p>- Robert Collier</p>
                </div>

                <div class="tips-grid">
                    <div class="tip-card">
                        <h4>üíß Stay Hydrated</h4>
                        <p>Drink water before meals to help control appetite and boost metabolism.</p>
                    </div>
                    <div class="tip-card">
                        <h4>ü•ó Meal Prep</h4>
                        <p>Prepare healthy meals in advance to avoid impulsive food choices.</p>
                    </div>
                    <div class="tip-card">
                        <h4>üò¥ Quality Sleep</h4>
                        <p>Aim for 7-9 hours of sleep to support weight management and recovery.</p>
                    </div>
                    <div class="tip-card">
                        <h4>üì± Track Progress</h4>
                        <p>Regular monitoring helps maintain motivation and accountability.</p>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profile" class="section profile-section">
                <h2>üë§ Your Profile</h2>
                
                <div class="profile-grid">
                    <div class="profile-avatar">
                        <div class="avatar-circle">üë§</div>
                        <h3>John Doe</h3>
                        <p>Member since: January 2024</p>
                    </div>
                    
                    <div>
                        <div class="input-group">
                            <label for="name">Full Name</label>
                            <input type="text" id="name" value="John Doe">
                        </div>
                        <div class="input-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" value="john@example.com">
                        </div>
                        <div class="input-group">
                            <label for="height">Height (cm)</label>
                            <input type="number" id="height" value="178">
                        </div>
                        <div class="input-group">
                            <label for="age">Age</label>
                            <input type="number" id="age" value="30">
                        </div>
                        <button class="btn" onclick="updateProfile()">Update Profile</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // SAVE NOTIFICATION SYSTEM
        // ========================================
        
        function showSaveIndicator(message = 'üíæ Data Saved!', type = 'success') {
            const indicator = document.getElementById('save-indicator');
            const text = document.getElementById('save-text');
            
            text.textContent = message;
            indicator.style.background = type === 'success' ? '#2ed573' : '#ff4757';
            indicator.classList.add('show');
            
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
            
            // Update sync status
            updateSyncStatus(message);
        }
        
        function updateSyncStatus(action = 'Data synchronized') {
            const syncMessage = document.getElementById('sync-message');
            const lastSave = document.getElementById('last-save');
            
            if (syncMessage) {
                syncMessage.textContent = action;
                lastSave.textContent = `Last saved: ${new Date().toLocaleTimeString()}`;
            }
        }
        
        function showUnsavedChanges() {
            const syncStatus = document.getElementById('sync-status');
            if (syncStatus) {
                syncStatus.className = 'data-sync-status unsaved-changes';
                document.getElementById('sync-message').textContent = 'Unsaved changes detected';
            }
        }
        
        function showSavedStatus() {
            const syncStatus = document.getElementById('sync-status');
            if (syncStatus) {
                syncStatus.className = 'data-sync-status';
                document.getElementById('sync-message').textContent = 'All data saved automatically';
            }
        }
        
        // ========================================
        // ENHANCED DATABASE SYSTEM
        // ========================================
        
        class BodyKeyDatabase {
            constructor() {
                this.dbName = 'bodykey-database';
                this.initializeDatabase();
            }
            
            // Initialize database structure
            initializeDatabase() {
                if (!localStorage.getItem(this.dbName)) {
                    const initialDB = {
                        profile: {},
                        weightLogs: [],
                        goals: [],
                        motivationData: {
                            dailyQuotes: [],
                            completedTips: [],
                            streakCount: 0
                        },
                        settings: {
                            theme: 'default',
                            units: 'metric',
                            notifications: true
                        },
                        statistics: {
                            totalLogins: 0,
                            lastLogin: null,
                            joinDate: new Date().toISOString()
                        }
                    };
                    this.saveDatabase(initialDB);
                }
                this.updateLoginStats();
            }
            
            // Get entire database
            getDatabase() {
                return JSON.parse(localStorage.getItem(this.dbName) || '{}');
            }
            
            // Save entire database
            saveDatabase(data) {
                localStorage.setItem(this.dbName, JSON.stringify(data));
            }
            
            // Update login statistics
            updateLoginStats() {
                const db = this.getDatabase();
                db.statistics.totalLogins += 1;
                db.statistics.lastLogin = new Date().toISOString();
                this.saveDatabase(db);
            }
            
            // PROFILE OPERATIONS
            saveProfile(profileData) {
                const db = this.getDatabase();
                db.profile = { ...db.profile, ...profileData, lastUpdated: new Date().toISOString() };
                this.saveDatabase(db);
                return true;
            }
            
            getProfile() {
                return this.getDatabase().profile;
            }
            
            // WEIGHT LOG OPERATIONS
            addWeightLog(weightData) {
                const db = this.getDatabase();
                const logEntry = {
                    id: Date.now(),
                    date: new Date().toISOString().split('T')[0],
                    timestamp: new Date().toISOString(),
                    ...weightData
                };
                db.weightLogs.push(logEntry);
                // Keep only last 365 entries for performance
                if (db.weightLogs.length > 365) {
                    db.weightLogs = db.weightLogs.slice(-365);
                }
                this.saveDatabase(db);
                return logEntry;
            }
            
            getWeightLogs() {
                return this.getDatabase().weightLogs;
            }
            
            getLatestWeight() {
                const logs = this.getWeightLogs();
                return logs.length > 0 ? logs[logs.length - 1] : null;
            }
            
            deleteWeightLog(id) {
                const db = this.getDatabase();
                db.weightLogs = db.weightLogs.filter(log => log.id !== id);
                this.saveDatabase(db);
            }
            
            // GOALS OPERATIONS
            addGoal(goalData) {
                const db = this.getDatabase();
                const goal = {
                    id: Date.now(),
                    text: goalData.text,
                    targetDate: goalData.targetDate || null,
                    category: goalData.category || 'general',
                    completed: false,
                    createdDate: new Date().toISOString().split('T')[0],
                    progress: 0
                };
                db.goals.push(goal);
                this.saveDatabase(db);
                return goal;
            }
            
            getGoals() {
                return this.getDatabase().goals;
            }
            
            updateGoal(id, updates) {
                const db = this.getDatabase();
                const goalIndex = db.goals.findIndex(goal => goal.id === id);
                if (goalIndex !== -1) {
                    db.goals[goalIndex] = { ...db.goals[goalIndex], ...updates };
                    this.saveDatabase(db);
                    return db.goals[goalIndex];
                }
                return null;
            }
            
            deleteGoal(id) {
                const db = this.getDatabase();
                db.goals = db.goals.filter(goal => goal.id !== id);
                this.saveDatabase(db);
            }
            
            // MOTIVATION DATA OPERATIONS
            saveMotivationData(data) {
                const db = this.getDatabase();
                db.motivationData = { ...db.motivationData, ...data };
                this.saveDatabase(db);
            }
            
            getMotivationData() {
                return this.getDatabase().motivationData;
            }
            
            // SETTINGS OPERATIONS
            updateSettings(settings) {
                const db = this.getDatabase();
                db.settings = { ...db.settings, ...settings };
                this.saveDatabase(db);
            }
            
            getSettings() {
                return this.getDatabase().settings;
            }
            
            // STATISTICS
            getStatistics() {
                return this.getDatabase().statistics;
            }
            
            // DATA EXPORT/IMPORT
            exportData() {
                return this.getDatabase();
            }
            
            importData(data) {
                this.saveDatabase(data);
                this.loadAllData();
            }
            
            // CLEAR ALL DATA
            clearAllData() {
                localStorage.removeItem(this.dbName);
                this.initializeDatabase();
            }
        }
        
        // Initialize database
        const db = new BodyKeyDatabase();
        
        // ========================================
        // UI FUNCTIONS
        // ========================================
        
        // Navigation functionality
        function showSection(sectionName) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(sectionName).classList.add('active');
            document.querySelector(`[data-section="${sectionName}"]`).classList.add('active');
            
            // Load section-specific data
            loadSectionData(sectionName);
        }
        
        // Load data for specific sections
        function loadSectionData(sectionName) {
            switch(sectionName) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'goals':
                    loadGoalsData();
                    break;
                case 'motivation':
                    loadMotivationData();
                    break;
                case 'profile':
                    loadProfileData();
                    break;
            }
        }
        
        // Dashboard functionality
        function logData() {
            const weight = document.getElementById('weight-input').value;
            const calories = document.getElementById('calories-input').value;
            const exercise = document.getElementById('exercise-input').value;
            
            if (weight) {
                // Show saving indicator
                showUnsavedChanges();
                
                const logEntry = db.addWeightLog({
                    weight: parseFloat(weight),
                    calories: calories ? parseInt(calories) : null,
                    exercise: exercise ? parseInt(exercise) : null
                });
                
                updateDashboardDisplay();
                
                // Show success notifications
                showSaveIndicator(`üìä Weight logged: ${weight} kg`);
                showSavedStatus();
                
                document.getElementById('log-message').innerHTML = 
                    `<div class="status-message">‚úÖ Weight entry saved! ID: #${logEntry.id}</div>`;
                
                // Clear inputs
                document.getElementById('weight-input').value = '';
                document.getElementById('calories-input').value = '';
                document.getElementById('exercise-input').value = '';
                
                // Show recent logs
                displayRecentLogs();
                
                // Update data stats
                displayDataStats();
            } else {
                showSaveIndicator('‚ö†Ô∏è Please enter weight first', 'error');
                alert('Please enter your weight to log data.');
            }
        }
        
        function loadDashboardData() {
            updateDashboardDisplay();
            displayRecentLogs();
            displayDataStats();
        }
        
        function updateDashboardDisplay() {
            const latestLog = db.getLatestWeight();
            const profile = db.getProfile();
            
            if (latestLog) {
                document.getElementById('current-weight').textContent = latestLog.weight;
                
                const goalWeight = parseFloat(document.getElementById('goal-weight').textContent);
                const progress = (77.4 - latestLog.weight).toFixed(1); // Starting weight was 77.4 kg
                document.getElementById('progress').textContent = progress;
                
                // BMI calculation with kg and cm (metric system)
                const heightCm = profile.height || 178; // Default height in cm
                const heightM = heightCm / 100; // Convert to meters
                const bmi = (latestLog.weight / (heightM * heightM)).toFixed(1);
                document.getElementById('bmi').textContent = bmi;
            }
        }
        
        function displayRecentLogs() {
            const logs = db.getWeightLogs().slice(-10).reverse();
            const logsContainer = document.getElementById('logs-display');
            
            if (logs.length === 0) {
                logsContainer.innerHTML = '<p style="text-align: center; color: #666;">No weight logs yet. Start tracking today!</p>';
                return;
            }
            
            logsContainer.innerHTML = logs.map(log => `
                <div class="log-item">
                    <div class="log-date">${new Date(log.date).toLocaleDateString()}</div>
                    <div class="log-weight">${log.weight} kg</div>
                    <div class="log-details">
                        ${log.calories ? `üçΩÔ∏è ${log.calories} cal` : ''}
                        ${log.exercise ? ` üí™ ${log.exercise} min` : ''}
                    </div>
                    <button class="delete-log" onclick="deleteLog(${log.id})">‚ùå</button>
                </div>
            `).join('');
        }
        
        function deleteLog(id) {
            if (confirm('Delete this log entry?')) {
                db.deleteWeightLog(id);
                displayRecentLogs();
                updateDashboardDisplay();
            }
        }
        
        function displayDataStats() {
            const stats = db.getStatistics();
            const logs = db.getWeightLogs();
            const goals = db.getGoals();
            const profile = db.getProfile();
            
            const statsContainer = document.getElementById('data-stats');
            statsContainer.innerHTML = `
                <div class="stat-item">
                    <div class="stat-number">${stats.totalLogins}</div>
                    <div class="stat-label">Total Logins</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${logs.length}</div>
                    <div class="stat-label">Weight Logs</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${goals.length}</div>
                    <div class="stat-label">Goals Set</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${Object.keys(profile).length}</div>
                    <div class="stat-label">Profile Fields</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${stats.lastLogin ? new Date(stats.lastLogin).toLocaleDateString() : 'Today'}</div>
                    <div class="stat-label">Last Login</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${new Date(stats.joinDate).toLocaleDateString()}</div>
                    <div class="stat-label">Join Date</div>
                </div>
            `;
        }
        
        // Goals functionality
        function addGoal() {
            const goalInput = document.getElementById('new-goal');
            const goalText = goalInput.value.trim();
            const goalCategory = document.getElementById('goal-category').value;
            const goalDate = document.getElementById('goal-date').value;
            
            if (goalText) {
                const goal = db.addGoal({ 
                    text: goalText,
                    category: goalCategory,
                    targetDate: goalDate || null
                });
                
                goalInput.value = '';
                document.getElementById('goal-date').value = '';
                loadGoalsData();
                
                showSaveIndicator(`üéØ Goal added: ${goalText.substring(0, 30)}${goalText.length > 30 ? '...' : ''}`);
                alert('Goal added successfully!');
            } else {
                showSaveIndicator('‚ö†Ô∏è Please enter a goal first', 'error');
                alert('Please enter a goal first.');
            }
        }
        
        function loadGoalsData() {
            const goals = db.getGoals();
            const goalsContainer = document.getElementById('goals-list');
            
            if (goals.length === 0) {
                goalsContainer.innerHTML = '<p style="text-align: center; color: #666;">No goals set yet. Add your first goal above!</p>';
                return;
            }
            
            goalsContainer.innerHTML = goals.map(goal => `
                <div class="goal-item ${goal.completed ? 'completed' : ''}">
                    <div class="goal-text ${goal.completed ? 'line-through' : ''}">${goal.text}</div>
                    <div class="goal-category">${goal.category}</div>
                    ${goal.targetDate ? `<div class="goal-date">üìÖ ${new Date(goal.targetDate).toLocaleDateString()}</div>` : ''}
                    <div class="goal-actions">
                        ${!goal.completed ? `<button class="goal-complete" onclick="completeGoal(${goal.id})">‚úì</button>` : ''}
                        <button class="goal-delete" onclick="deleteGoal(${goal.id})">‚ùå</button>
                    </div>
                </div>
            `).join('');
            
            console.log('Goals loaded:', goals.length);
        }
        
        function completeGoal(id) {
            db.updateGoal(id, { completed: true, completedDate: new Date().toISOString().split('T')[0] });
            loadGoalsData();
        }
        
        function deleteGoal(id) {
            if (confirm('Delete this goal?')) {
                db.deleteGoal(id);
                loadGoalsData();
            }
        }
        
        function loadMotivationData() {
            const motivationData = db.getMotivationData();
            // Update motivation display
            console.log('Motivation data loaded:', motivationData);
        }
        
        // Profile functionality
        function updateProfile() {
            const profileData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                height: document.getElementById('height').value,
                age: document.getElementById('age').value
            };
            
            db.saveProfile(profileData);
            showSaveIndicator(`üë§ Profile updated for ${profileData.name || 'User'}`);
            alert('Profile updated successfully!');
            
            // Update dashboard if height changed
            updateDashboardDisplay();
        }
        
        function loadProfileData() {
            const profile = db.getProfile();
            if (profile.name) {
                document.getElementById('name').value = profile.name || '';
                document.getElementById('email').value = profile.email || '';
                document.getElementById('height').value = profile.height || '';
                document.getElementById('age').value = profile.age || '';
            }
        }
        
        // Add click listeners to nav buttons
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const section = this.getAttribute('data-section');
                showSection(section);
            });
        });
        
        // Load all data on page load
        function loadAllData() {
            loadProfileData();
            loadDashboardData();
            loadGoalsData();
            loadMotivationData();
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadAllData();
            
            // Add auto-save listeners for profile fields
            const profileFields = ['name', 'email', 'height', 'age'];
            profileFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('blur', function() {
                        const profileData = {
                            name: document.getElementById('name').value,
                            email: document.getElementById('email').value,
                            height: document.getElementById('height').value,
                            age: document.getElementById('age').value
                        };
                        if (profileData[fieldId.replace('-', '')]) {
                            db.saveProfile(profileData);
                            showSaveIndicator(`üë§ ${fieldId} auto-saved`);
                            updateDashboardDisplay(); // Update BMI if height changed
                        }
                    });
                }
            });
            
            // Add input validation feedback
            const weightInput = document.getElementById('weight-input');
            if (weightInput) {
                weightInput.addEventListener('input', function() {
                    const value = parseFloat(this.value);
                    if (value && (value < 20 || value > 450)) {
                        this.style.borderColor = '#ff4757';
                        showSaveIndicator('‚ö†Ô∏è Please check weight value (20-450 kg)', 'error');
                    } else {
                        this.style.borderColor = '#e0e0e0';
                    }
                });
            }
            
            const stats = db.getStatistics();
            console.log('üéØ BodyKey Database System Loaded Successfully!');
            console.log(`üìä Total logins: ${stats.totalLogins}`);
            console.log(`üë§ Profile data: ${Object.keys(db.getProfile()).length} fields`);
            console.log(`üìà Weight logs: ${db.getWeightLogs().length} entries`);
            console.log(`üéØ Goals: ${db.getGoals().length} active`);
            
            // Show welcome save status
            setTimeout(() => {
                updateSyncStatus('System ready - all data will auto-save');
            }, 1000);
        });
        
        // Data Management Functions
        function exportData() {
            const data = db.exportData();
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `bodykey-data-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert('üì§ Data exported successfully!');
        }
        
        function showImportDialog() {
            const dialog = document.createElement('div');
            dialog.className = 'import-dialog';
            dialog.style.display = 'flex';
            dialog.innerHTML = `
                <div class="import-content">
                    <h3>üì• Import BodyKey Data</h3>
                    <p>Paste your exported JSON data below:</p>
                    <textarea id="import-data" class="import-textarea" placeholder="Paste your BodyKey data here..."></textarea>
                    <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                        <button class="btn" onclick="closeImportDialog()">‚ùå Cancel</button>
                        <button class="btn" onclick="importData()">‚úÖ Import</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(dialog);
        }
        
        function closeImportDialog() {
            const dialog = document.querySelector('.import-dialog');
            if (dialog) {
                document.body.removeChild(dialog);
            }
        }
        
        function importData() {
            const textarea = document.getElementById('import-data');
            try {
                const data = JSON.parse(textarea.value);
                db.importData(data);
                closeImportDialog();
                alert('üì• Data imported successfully!');
                // Refresh current section
                const activeSection = document.querySelector('.section.active').id;
                loadSectionData(activeSection);
            } catch (error) {
                alert('‚ùå Invalid JSON data. Please check your input.');
            }
        }
        
        function clearAllData() {
            if (confirm('‚ö†Ô∏è Are you sure you want to clear ALL data? This cannot be undone!')) {
                if (confirm('üóëÔ∏è This will delete all your weight logs, goals, and profile data. Continue?')) {
                    db.clearAllData();
                    alert('üóëÔ∏è All data cleared successfully!');
                    // Refresh all displays
                    loadAllData();
                }
            }
        }
    </script>
</body>
</html>